@model DashboardViewModel
@{
    Layout = "~/Views/Shared/AdminLayout.cshtml";

}
<div class="row">
    <!-- Statistics Section -->
    <div class="col-md-4 grid-margin stretch-card">
        <div class="card">
            <div class="card-body">
                <p class="card-title">Key Statistics</p>
                <div class="statistics">
                    <div class="stat-item">
                        <p>Total Registered Members: @Model.RegisteredMembersCount</p>
                    </div>
                    <div class="stat-item">
                        <p>Active Subscriptions: @Model.ActiveSubscriptionsCount</p>
                    </div>
                    <div class="stat-item">
                        <p>Total Revenue: @Model.TotalRevenue</p>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div>
        <canvas id="monthlyChart"></canvas>
        <canvas id="annualChart"></canvas>
        <canvas id="topPlansChart"></canvas>
        <canvas id="paymentsChart"></canvas>
        <canvas id="usersChart"></canvas>
        <canvas id="testimonialsChart"></canvas>
    </div>

    <script>
        // Monthly Subscription Report (Line Chart)
        const monthlyLabels = @Html.Raw(Json.Serialize(Model.MonthlySubscriptionReport.Select(item => $"{item.Month}-{item.Year}")));
        const monthlyData = @Html.Raw(Json.Serialize(Model.MonthlySubscriptionReport.Select(item => item.TotalAmount)));
        const monthlyChartConfig = {
            type: 'line',
            data: {
                labels: monthlyLabels,
                datasets: [{
                    label: 'Monthly Revenue',
                    data: monthlyData,
                    fill: false,
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1,
                    tension: 0.1
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { position: 'top' },
                    title: { display: true, text: 'Monthly Subscription Revenue' }
                },
                scales: {
                    x: { beginAtZero: true },
                    y: { beginAtZero: true }
                }
            }
        };
        const monthlyCtx = document.getElementById('monthlyChart').getContext('2d');
        new Chart(monthlyCtx, monthlyChartConfig);

        // Repeat similar blocks for other charts...
    </script>


<div class="row">
    <!-- Top Plans Table -->
    <div class="col-md-7 grid-margin stretch-card">
        <div class="card">
            <div class="card-body">
                <p class="card-title mb-0">Top Plans</p>
                <div class="table-responsive">
                    <table class="table table-striped table-borderless">
                        <thead>
                            <tr>
                                <th>Plan Title</th>
                                <th>Price</th>
                                <th>Trainer Name</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model.Item1)
                            {
                                <tr>
                                    <td>@item.Title</td>
                                    <td class="font-weight-bold">@item.Price</td>
                                    <td>@item.Trainer.UserName</td>
                                    <td class="font-weight-medium">
                                        <div class="badge badge-success">@item.Descriptions</div>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Tostominals Table -->
    <div class="col-md-7 grid-margin stretch-card">
        <div class="card">
            <div class="card-body">
                <p class="card-title mb-0">Tostominals</p>
                <div class="table-responsive">
                    <table class="table table-striped table-borderless">
                        <thead>
                            <tr>
                                <th>Title</th>
                                <th>Rate</th>
                                <th>User Name</th>
                                <th>Created Time</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model.Item4)
                            {
                                <tr>
                                    <td>@item.Text</td>
                                    <td class="font-weight-bold">@item.Rate</td>
                                    <td class="font-weight-medium">
                                        <div class="badge badge-success">@item.User.UserName</div>
                                    </td>
                                    <td>@item.RatedTime</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Payments Table -->
    <div class="col-md-4 stretch-card grid-margin">
        <div class="card">
            <div class="card-body">
                <p class="card-title mb-0">Payments</p>
                <div class="table-responsive">
                    <table class="table table-borderless">
                        <thead>
                            <tr>
                                <th class="pl-0 pb-2 border-bottom">Amount</th>
                                <th class="border-bottom pb-2">Plan Title</th>
                                <th class="border-bottom pb-2">Username</th>
                                <th class="border-bottom pb-2">IsUsedPromo</th>
                                <th class="border-bottom pb-2">TransactionDate</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model.Item2)
                            {
                                <tr>
                                    <td class="pl-0">@item.Amount</td>
                                    <td>@item.Plan.Title</td>
                                    <td>@item.User.UserName</td>
                                    <td>@item.IsUsedPromo</td>
                                    <td>@item.TransactionDate</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Users Table -->
    <div class="col-md-12 grid-margin stretch-card">
        <div class="card">
            <div class="card-body">
                <p class="card-title">Users Table</p>
                <div class="row">
                    <div class="col-12">
                        <div class="table-responsive">
                            <table id="example" class="display expandable-table" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>Email</th>
                                        <th>Image</th>
                                        <th>User Name</th>
                                        <th>Role Name</th>
                                        <th>Is Blocked</th>
                                        <th>Created Time</th>
                                        <th>Updated Time</th>
                                        <th>Last Login</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var item in Model.Item3)
                                    {
                                        <tr>
                                            <td>@item.Email</td>
                                            <td>
                                                <img src="@Url.Content("~/Images/" + item.UserImage)" style="border-radius:20%;" width="100" height="100" />
                                            </td>
                                            <td>@item.UserName</td>
                                            <td>@item.Role</td>
                                            <td>@item.Isblock</td>
                                            <td>@item.CreatedAt</td>
                                            <td>@item.UpdateAt</td>
                                            <td>@item.LastLogin</td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Include Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
